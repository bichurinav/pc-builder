"use strict";function _typeof2(e){return(_typeof2="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}!function i(a,s,c){function l(t,e){if(!s[t]){if(!a[t]){var n="function"==typeof require&&require;if(!e&&n)return n(t,!0);if(u)return u(t,!0);var o=new Error("Cannot find module '"+t+"'");throw o.code="MODULE_NOT_FOUND",o}var r=s[t]={exports:{}};a[t][0].call(r.exports,function(e){return l(a[t][1][e]||e)},r,r.exports,i,a,s,c)}return s[t].exports}for(var u="function"==typeof require&&require,e=0;e<c.length;e++)l(c[e]);return l}({1:[function(e,t,n){function r(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var o=function(){function e(){if(!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.formAddComponent=document.querySelector("#form-add-component"),!this.formAddComponent)throw new Error("Не была найдена форма #form-add-component");if(this.formAddComponentSelect=document.querySelector("#form-add-component-select"),!this.formAddComponentSelect)throw new Error("Не был найден select #form-add-component-select у формы");if(this.formAddComponentUpload=document.querySelector("#form-add-component-upload"),!this.formAddComponentUpload)throw new Error("Не был найден upload-изображений #form-add-component-select у формы");if(this.fields=document.querySelectorAll(".form-add-component__form input"),!this.formAddComponentUpload)throw new Error("Не были найдеы поля у формы");this.ajaxURL="modules/Component.php",this.addEventListener()}var t,n,o;return t=e,(n=[{key:"changeComponent",value:function(e){document.location.href="/?component=".concat(e.target.value)}},{key:"uploadImage",value:function(e){var t=document.querySelector(".upload-file__text"),n=e.target.files[0];5242880<n.size?t.textContent="Изображение не более 5 МБ.":t.textContent=n.name}},{key:"addComponentInDB",value:function(e){var t;e.event.preventDefault(),this.isFormValid(this.fields)&&((t=new FormData(e.event.target)).append("action",e.action),fetch(e.url,{method:"POST",body:t}).then(function(e){return e.text()}).then(function(e){e&&setTimeout(function(){document.location.href="/?component=".concat(e)},0)}))}},{key:"isFormValid",value:function(e){var n=[];return e.forEach(function(e){function t(e){return"file"===e.getAttribute("type")}""===e.value?(e.nextElementSibling.classList.contains("field__error")&&e.nextElementSibling.classList.add("error"),t(e)&&e.nextElementSibling.children[1].classList.add("error"),n.push(e)):(e.nextElementSibling.classList.remove("error"),t(e)&&e.nextElementSibling.children[1].classList.remove("error"))}),!n.length}},{key:"addEventListener",value:function(){var t=this;this.formAddComponentSelect.addEventListener("change",function(e){return t.changeComponent(e)}),this.formAddComponentUpload.addEventListener("change",function(e){return t.uploadImage(e)}),this.formAddComponent.addEventListener("submit",function(e){return t.addComponentInDB({action:"add",event:e,url:t.ajaxURL})})}}])&&r(t.prototype,n),o&&r(t,o),e}();n.default=o},{}],2:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var o,r=(o=e("./AddComponent"))&&o.__esModule?o:{default:o};function i(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),this.formAddComponent=new r.default}n.default=i},{"./AddComponent":1}],3:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var o,r=(o=e("./LoadComponents"))&&o.__esModule?o:{default:o};function i(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),this.loadComponents=new r.default}n.default=i},{"./LoadComponents":4}],4:[function(e,t,n){function r(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var o=function(){function e(){if(!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.catalogContent=document.querySelector(".catalog-content"),!this.catalogContent)throw new Error("Не найден .catalog-content");this.showComponents=4,this.countComponents=0,this.offset=0,this.components=[],this.action="load",this.ajaxURL="modules/Component.php",this.loadComponentFromDB(this.action,this.ajaxURL,this.offset)}var t,n,o;return t=e,(n=[{key:"loadComponentFromDB",value:function(e,t,n){var o=this,r=2<arguments.length&&void 0!==n?n:0,i=new FormData;i.append("action",e),i.append("component",this.getParamURL("component")),i.append("offset",Number(r)),i.append("limit",Number(this.showComponents));var a=fetch(t,{method:"POST",body:i});this.setPreloader(),a.then(function(e){return e.json()}).then(function(e){setTimeout(function(){o.render(e)},500)})}},{key:"render",value:function(e){var o=this;if(this.catalogContent.innerHTML="",this.catalogContent.insertAdjacentHTML("afterbegin",'\n            <div class="catalog-content-items"></div>\n        '),this.components=e.items,this.countComponents=Number(e.count),this.catalog=document.querySelector(".catalog-content-items"),!this.catalog)throw new Error("Не найден .catalog-content-items");this.components?(this.components.forEach(function(e){var t=[];for(var n in e)"name"!==n&&"id"!==n&&"image"!==n&&t.push("<span><b>".concat(n.replaceAll("_"," "),"</b>: ").concat(e[n],"</span><br>"));o.catalog.innerHTML+='\n            <div class="catalog-content__item">\n                <div class="catalog-content__item-image">\n                    <img width="100" src="'.concat(e.image,'">\n                </div>\n                <div class="catalog-content__item-info">\n                    <h2>').concat(e.name,"</h2>\n                    <div>\n                        ").concat(t.join(""),"\n                    </div>\n                </div>\n            </div>\n            ")}),this.countComponents>this.showComponents&&this.setPagination()):this.catalog.innerHTML="<b>Пусто :(</b>"}},{key:"setPagination",value:function(){var n=this;this.pagination&&this.pagination.remove();function o(e,t){var n=null;return n=e%t!=0?Math.ceil(e/t):e/t,n}var e=this.pagination=document.createElement("div");e.classList.add("catalog-content-pagination"),this.catalog.insertAdjacentElement("afterEnd",e),e.insertAdjacentHTML("afterBegin",'\n            <button offset class="catalog-pagination__btn prev">Prev page</button>\n            <span class="catalog-pagination__pages">\n                '.concat(localStorage.getItem("page")," из ").concat(o(this.countComponents,this.showComponents),'\n            </span>\n            <button offset class="catalog-pagination__btn next">Next Page</button>\n        ')),e.querySelectorAll(".catalog-pagination__btn").forEach(function(t){t.addEventListener("click",function(){var e;t.classList.contains("next")?localStorage.getItem("page")<o(n.countComponents,n.showComponents)?localStorage.setItem("page",Number(localStorage.getItem("page"))+1):localStorage.setItem("page",1):1==localStorage.getItem("page")?localStorage.setItem("page",o(n.countComponents,n.showComponents)):localStorage.setItem("page",localStorage.getItem("page")-1),e="page",t.setAttribute("offset",Number(localStorage.getItem(e))*n.showComponents-n.showComponents),n.offset=t.getAttribute("offset"),n.loadComponentFromDB(n.action,n.ajaxURL,n.offset)})})}},{key:"setPreloader",value:function(){this.catalogContent.innerHTML="",this.catalogContent.insertAdjacentHTML("afterbegin",'\n            <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" style="margin: auto; display: block; shape-rendering: auto;" width="197px" height="197px" viewBox="0 0 100 100" preserveAspectRatio="xMidYMid">\n            <circle cx="50" cy="50" r="0" fill="none" stroke="#0051a2" stroke-width="2">\n            <animate attributeName="r" repeatCount="indefinite" dur="1.2987012987012987s" values="0;35" keyTimes="0;1" keySplines="0 0.2 0.8 1" calcMode="spline" begin="-0.6493506493506493s"></animate>\n            <animate attributeName="opacity" repeatCount="indefinite" dur="1.2987012987012987s" values="1;0" keyTimes="0;1" keySplines="0.2 0 0.8 1" calcMode="spline" begin="-0.6493506493506493s"></animate>\n            </circle>\n            <circle cx="50" cy="50" r="0" fill="none" stroke="#1b75be" stroke-width="2">\n            <animate attributeName="r" repeatCount="indefinite" dur="1.2987012987012987s" values="0;35" keyTimes="0;1" keySplines="0 0.2 0.8 1" calcMode="spline"></animate>\n            <animate attributeName="opacity" repeatCount="indefinite" dur="1.2987012987012987s" values="1;0" keyTimes="0;1" keySplines="0.2 0 0.8 1" calcMode="spline"></animate>\n            </circle>\n            </svg>\n        ')}},{key:"getParamURL",value:function(e){var t=window.location.search;return!!(t=t.match(new RegExp(e+"=([^&=]+)")))&&t[1]}}])&&r(t.prototype,n),o&&r(t,o),e}();n.default=o},{}],5:[function(e,t,n){var o=a(e("./Catalog/Catalog")),r=a(e("./Admin/Admin")),i=a(e("events"));function a(e){return e&&e.__esModule?e:{default:e}}function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function l(i){var a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t,n,o,r=u(i);return t=a?(e=u(this).constructor,Reflect.construct(r,arguments,e)):r.apply(this,arguments),n=this,!(o=t)||"object"!==s(o)&&"function"!=typeof o?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(n):o}}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}new(function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}(n,i.default);var t=l(n);function n(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),e=t.call(this),localStorage.setItem("page",1),e.session=!0,e.session&&(e.admin=new r.default),e.catalog=new o.default,e}return n}())},{"./Admin/Admin":2,"./Catalog/Catalog":3,events:6}],6:[function(e,t,n){var c=Object.create||function(e){function t(){}return t.prototype=e,new t},a=Object.keys||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n);return n},i=Function.prototype.bind||function(e){var t=this;return function(){return t.apply(e,arguments)}};function o(){this._events&&Object.prototype.hasOwnProperty.call(this,"_events")||(this._events=c(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0}((t.exports=o).EventEmitter=o).prototype._events=void 0,o.prototype._maxListeners=void 0;var r,s=10;try{var l={};Object.defineProperty&&Object.defineProperty(l,"x",{value:0}),r=0===l.x}catch(e){r=!1}function u(e){return void 0===e._maxListeners?o.defaultMaxListeners:e._maxListeners}function f(e,t,n,o){var r,i,a,s;if("function"!=typeof n)throw new TypeError('"listener" argument must be a function');return(r=e._events)?(r.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),r=e._events),i=r[t]):(r=e._events=c(null),e._eventsCount=0),i?("function"==typeof i?i=r[t]=o?[n,i]:[i,n]:o?i.unshift(n):i.push(n),i.warned||(s=u(e))&&0<s&&i.length>s&&(i.warned=!0,(a=new Error("Possible EventEmitter memory leak detected. "+i.length+' "'+String(t)+'" listeners added. Use emitter.setMaxListeners() to increase limit.')).name="MaxListenersExceededWarning",a.emitter=e,a.type=t,a.count=i.length,"object"===("undefined"==typeof console?"undefined":_typeof2(console))&&console.warn&&console.warn("%s: %s",a.name,a.message))):(i=r[t]=n,++e._eventsCount),e}function p(){if(!this.fired)switch(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length){case 0:return this.listener.call(this.target);case 1:return this.listener.call(this.target,arguments[0]);case 2:return this.listener.call(this.target,arguments[0],arguments[1]);case 3:return this.listener.call(this.target,arguments[0],arguments[1],arguments[2]);default:for(var e=new Array(arguments.length),t=0;t<e.length;++t)e[t]=arguments[t];this.listener.apply(this.target,e)}}function h(e,t,n){var o={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},r=i.call(p,o);return r.listener=n,o.wrapFn=r}function m(e,t,n){var o=e._events;if(!o)return[];var r=o[t];return r?"function"==typeof r?n?[r.listener||r]:[r]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(r):v(r,r.length):[]}function d(e){var t=this._events;if(t){var n=t[e];if("function"==typeof n)return 1;if(n)return n.length}return 0}function v(e,t){for(var n=new Array(t),o=0;o<t;++o)n[o]=e[o];return n}r?Object.defineProperty(o,"defaultMaxListeners",{enumerable:!0,get:function(){return s},set:function(e){if("number"!=typeof e||e<0||e!=e)throw new TypeError('"defaultMaxListeners" must be a positive number');s=e}}):o.defaultMaxListeners=s,o.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||isNaN(e))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=e,this},o.prototype.getMaxListeners=function(){return u(this)},o.prototype.emit=function(e,t,n,o){var r,i,a,s,c="error"===e,l=this._events;if(l)c=c&&null==l.error;else if(!c)return!1;if(c){if(1<arguments.length&&(r=t),r instanceof Error)throw r;var u=new Error('Unhandled "error" event. ('+r+")");throw u.context=r,u}if(!(i=l[e]))return!1;var f,p="function"==typeof i;switch(f=arguments.length){case 1:!function(e,t,n){if(t)e.call(n);else for(var o=e.length,r=v(e,o),i=0;i<o;++i)r[i].call(n)}(i,p,this);break;case 2:!function(e,t,n,o){if(t)e.call(n,o);else for(var r=e.length,i=v(e,r),a=0;a<r;++a)i[a].call(n,o)}(i,p,this,t);break;case 3:!function(e,t,n,o,r){if(t)e.call(n,o,r);else for(var i=e.length,a=v(e,i),s=0;s<i;++s)a[s].call(n,o,r)}(i,p,this,t,n);break;case 4:!function(e,t,n,o,r,i){if(t)e.call(n,o,r,i);else for(var a=e.length,s=v(e,a),c=0;c<a;++c)s[c].call(n,o,r,i)}(i,p,this,t,n,o);break;default:for(a=new Array(f-1),s=1;s<f;s++)a[s-1]=arguments[s];!function(e,t,n,o){if(t)e.apply(n,o);else for(var r=e.length,i=v(e,r),a=0;a<r;++a)i[a].apply(n,o)}(i,p,this,a)}return!0},o.prototype.on=o.prototype.addListener=function(e,t){return f(this,e,t,!1)},o.prototype.prependListener=function(e,t){return f(this,e,t,!0)},o.prototype.once=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.on(e,h(this,e,t)),this},o.prototype.prependOnceListener=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.prependListener(e,h(this,e,t)),this},o.prototype.removeListener=function(e,t){var n,o,r,i,a;if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');if(!(o=this._events))return this;if(!(n=o[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=c(null):(delete o[e],o.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(r=-1,i=n.length-1;0<=i;i--)if(n[i]===t||n[i].listener===t){a=n[i].listener,r=i;break}if(r<0)return this;0===r?n.shift():function(e,t){for(var n=t,o=n+1,r=e.length;o<r;n+=1,o+=1)e[n]=e[o];e.pop()}(n,r),1===n.length&&(o[e]=n[0]),o.removeListener&&this.emit("removeListener",e,a||t)}return this},o.prototype.removeAllListeners=function(e){var t,n=this._events;if(!n)return this;if(!n.removeListener)return 0===arguments.length?(this._events=c(null),this._eventsCount=0):n[e]&&(0==--this._eventsCount?this._events=c(null):delete n[e]),this;if(0===arguments.length){for(var o,r=a(n),i=0;i<r.length;++i)"removeListener"!==(o=r[i])&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=c(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(t)for(i=t.length-1;0<=i;i--)this.removeListener(e,t[i]);return this},o.prototype.listeners=function(e){return m(this,e,!0)},o.prototype.rawListeners=function(e){return m(this,e,!1)},o.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):d.call(e,t)},o.prototype.listenerCount=d,o.prototype.eventNames=function(){return 0<this._eventsCount?Reflect.ownKeys(this._events):[]}},{}]},{},[5]);
//# sourceMappingURL=maps/main.js.map
